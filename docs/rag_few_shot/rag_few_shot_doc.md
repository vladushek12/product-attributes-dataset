# Доклад о методе RAG Few Shot

Это метод, при котором генеративная модель (например, GPT) получает дополнительный контекст из внешней базы знаний (например, векторного хранилища). Это позволяет модели давать более точные ответы на сложные вопросы.

## **1. Архитектура RAG Few-shot**

### **1.1. Основные компоненты**
RAG Few-shot состоит из двух ключевых блоков:
- **Retrieval (поисковая часть)**:
  - Использует поисковые механизмы для извлечения релевантной информации из внешних источников.
  - Обычно это реализуется через индексацию больших корпусов текста с помощью методов вроде **Dense Retrieval** (например, FAISS или Elasticsearch) или **Sparse Retrieval** (TF-IDF, BM25).
  - Поиск может быть настроен на работу с базами знаний, документами, научными статьями, новостями и другими источниками.

- **Generation (генеративная часть)**:
  - После получения релевантных документов модель генерирует ответ, используя найденную информацию в сочетании с внутренними знаниями.
  - Генерация основана на языковых моделях (например, GPT, T5, BART), которые могут работать с контекстом, предоставленным как few-shot примеры.

### **1.2. Интеграция Few-shot Learning**
Few-shot Learning интегрируется в процесс следующим образом:
1. **Примеры из поиска**:
   - Найденные документы или фрагменты текста используются как дополнительные примеры для задачи.
   - Например, если пользователь задает вопрос о программировании, поиск может найти похожие кодовые примеры, которые модель использует как few-shot данные.

2. **Промпт для модели**:
   - Модель получает комбинированный промпт, состоящий из:
     - Релевантных данных из поиска (few-shot примеры).
     - Собственно запрос пользователя.
   - Это позволяет модели быстрее адаптироваться к задаче, даже если она никогда не сталкивалась с подобными вопросами.

---

## **2. Принцип работы**

### **2.1. Этапы выполнения запроса**
1. **Получение запроса**:
   - Пользователь формулирует вопрос или задачу.

2. **Поиск релевантной информации**:
   - Система отправляет запрос в поисковую систему или базу данных.
   - Возвращаются топ-N наиболее подходящих документов или фрагментов текста.

3. **Формирование контекста**:
   - Найденная информация используется для создания few-shot примеров.
   - Например, если запрос связан с медицинской диагностикой, система может найти клинические случаи, аналогичные описанию пользователя.

4. **Генерация ответа**:
   - Модель получает комбинированный вход: запрос + few-shot примеры.
   - На основе этого входа генерируется ответ, учитывающий как внутренние знания модели, так и внешние данные.

---

## **3. Особенности реализации**

### **3.1. Выбор поискового механизма**
- **Dense Retrieval**:
  - Использует эмбеддинги текста (например, через Sentence-BERT) для поиска семантически близких документов.
  - Подходит для сложных запросов, где важны смысловые связи.

- **Sparse Retrieval**:
  - Использует традиционные методы вроде TF-IDF или BM25.
  - Быстрее, но менее точен при сложных запросах.

### **3.2. Обработка найденных данных**
- **Фильтрация**:
  - Не все найденные документы одинаково полезны. Система должна отфильтровывать нерелевантные или устаревшие данные.
- **Сжатие**:
  - Большие документы можно свести к коротким фрагментам или тезисам, чтобы упростить их использование как few-shot примеры.

### **3.3. Адаптация модели**
- Модель может быть предварительно обучена на данных, содержащих few-shot примеры, чтобы лучше понимать их структуру.
- Также можно использовать fine-tuning для адаптации модели под конкретную задачу.

---

## **4. Преимущества RAG Few-shot**

1. **Актуальность**:
   - Возможность использовать последние данные, которых нет в обучающей выборке модели.

2. **Гибкость**:
   - Система может быстро адаптироваться к новым задачам за счет few-shot примеров.

3. **Точность**:
   - Комбинация внутренних знаний модели и внешних данных повышает качество ответов.

4. **Широкий спектр применения**:
   - Ответы на вопросы, генерация текстов, решение задач в области права, медицины, финансов и других областей.

---

## **5. Ограничения и вызовы**

1. **Качество поиска**:
   - Если поисковая система возвращает нерелевантные данные, это может снизить точность ответа.

2. **Размер контекста**:
   - Языковые модели имеют ограничения на размер входного контекста. Если найденные данные слишком объемны, их нужно эффективно сжимать.

3. **Устаревшие данные**:
   - Внешние источники могут содержать устаревшую информацию, что требует дополнительной фильтрации.

4. **Сложность настройки**:
   - Интеграция поисковой системы и генеративной модели может потребовать значительных усилий.

---

## **6. Заключение**
RAG Few-shot — это мощный инструмент, который объединяет лучшие практики из мира поиска и генерации. Он особенно полезен в ситуациях, где требуется высокая точность и актуальность, а также при работе с ограниченным количеством данных.

---

## Источники

https://arxiv.org/pdf/2410.12837 \
https://habr.com/ru/articles/862870/ \
https://habr.com/ru/articles/779526/
